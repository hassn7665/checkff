

<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>التحقق من البطاقة</title>
<style>
body {
    font-family: Arial, sans-serif;
    direction: rtl;
    text-align: right;
    background: #f5f5f5;
    padding: 30px;
}
.card {
    background: white;
    padding: 20px;
    border-radius: 10px;
    max-width: 500px;
    margin: auto;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
}
</style>
</head>
<body>

<div class="card" id="result">جارٍ التحقق...</div>

<script>
const sheetCSV =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vRRAzjYWiKgq1g8LKGfHZUHsQjlE8ibxFG8OsS3PrZYje5QPecRzQNw5onhFWrczCj3YIDa2gkzMd7n/pub?output=csv";

function getSN() {
    return new URLSearchParams(window.location.search).get("sn");
}

fetch(sheetCSV)
.then(res => res.text())
.then(text => {
    const rows = text.trim().split("\n").map(r => r.split(","));
    const headers = rows[0];
    const sn = getSN();

    for (let i = 1; i < rows.length; i++) {
        let row = {};
        headers.forEach((h, j) => row[h.trim()] = rows[i][j]?.trim());

        if (row["sn"] === sn) {
            document.getElementById("result").innerHTML = `
                <h2>تم التحقق بنجاح ✅</h2>
                <p><strong>الاسم الثلاثي:</strong> ${row["الاسم الثلاثي"]}</p>
                <p><strong>الصفة النقابية:</strong> ${row["الصفة النقابية"]}</p>
                <p><strong>الرقم النقابي:</strong> ${row["الرقم النقابي"]}</p>
                <p><strong>تاريخ الإصدار:</strong> ${row["تاريخ الاصدار"]}</p>
                <p><strong>تاريخ الانتهاء:</strong> ${row["تاريخ الانتهاء"]}</p>
            `;
            return;
        }
    }

    document.getElementById("result").innerHTML =
        "<h3>❌ لم يتم العثور على البطاقة</h3>";
});
</script>

</body>
</html>