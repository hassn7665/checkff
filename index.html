

<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>التحقق من البطاقة</title>
<style>
body {
    font-family: Arial, sans-serif;
    direction: rtl;
    text-align: center;
    background: #f5f5f5;
}
.container {
    background: white;
    padding: 20px;
    margin: 40px auto;
    width: 90%;
    max-width: 400px;
    border-radius: 10px;
}
</style>
</head>
<body>

<div class="container">
    <h2>نتيجة التحقق</h2>
    <div id="result">جاري التحقق...</div>
</div>

<script>
const csvURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRRAzjYWiKgq1g8LKGfHZUHsQjlE8ibxFG8OsS3PrZYje5QPecRzQNw5onhFWrczCj3YIDa2gkzMd7n/pub?output=csv";

const params = new URLSearchParams(window.location.search);
const snFromQR = params.get("sn");

if (!snFromQR) {
    document.getElementById("result").innerHTML = "❌ رقم البطاقة غير موجود";
}

fetch(csvURL)
.then(res => res.text())
.then(csv => {
    const rows = csv.split("\n").map(r => r.split(","));
    const headers = rows[0];

    const indexSN = headers.indexOf("SN");
    const indexName = headers.indexOf("name");
    const indexUnion = headers.indexOf("union");
    const indexRole = headers.indexOf("role");

    const card = rows.find((row, i) => i > 0 && row[indexSN] === snFromQR);

    const resultDiv = document.getElementById("result");

    if (card) {
        resultDiv.innerHTML = `
            <p><strong>الاسم الثلاثي:</strong> ${card[indexName]}</p>
            <p><strong>الرقم النقابي:</strong> ${card[indexUnion]}</p>
            <p><strong>الصفة النقابية:</strong> ${card[indexRole]}</p>
        `;
    } else {
        resultDiv.innerHTML = "❌ لم يتم العثور على البطاقة";
    }
});
</script>

</body>
</html>