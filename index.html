

<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>التحقق من البطاقة</title>
<style>
body {
    font-family: Arial, sans-serif;
    direction: rtl;
    text-align: center;
    background: #f2f2f2;
}
.box {
    background: white;
    padding: 20px;
    margin: 50px auto;
    width: 90%;
    max-width: 400px;
    border-radius: 10px;
}
</style>
</head>
<body>

<div class="box">
    <h2>نتيجة التحقق</h2>
    <div id="result">جاري التحقق...</div>
</div>

<script>
const params = new URLSearchParams(window.location.search);
const sn = params.get("sn");

if (!sn) {
    document.getElementById("result").innerHTML = "❌ رقم البطاقة غير موجود";
    throw new Error("No SN");
}

// رابط Google Sheet بصيغة JSON
const sheetURL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vRRAzjYWiKgq1g8LKGfHZUHsQjlE8ibxFG8OsS3PrZYje5QPecRzQNw5onhFWrczCj3YIDa2gkzMd7n/gviz/tq?tqx=out:json";

fetch(sheetURL)
.then(res => res.text())
.then(text => {
    const json = JSON.parse(text.substring(47).slice(0, -2));
    const rows = json.table.rows;

    let found = null;

    rows.forEach(r => {
        const rowSN = r.c[6]?.v?.toString().trim(); // العمود SN
        if (rowSN === sn.trim()) {
            found = {
                name: r.c[0]?.v,
                union: r.c[1]?.v,
                role: r.c[2]?.v
            };
        }
    });

    const result = document.getElementById("result");

    if (found) {
        result.innerHTML = `
            <p><strong>الاسم الثلاثي:</strong> ${found.name}</p>
            <p><strong>الرقم النقابي:</strong> ${found.union}</p>
            <p><strong>الصفة النقابية:</strong> ${found.role}</p>
        `;
    } else {
        result.innerHTML = "❌ لم يتم العثور على البطاقة";
    }
});
</script>

</body>
</html>